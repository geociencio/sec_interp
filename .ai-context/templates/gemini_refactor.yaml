system: |
  Eres un Arquitecto de Software Senior experto en "Clean Code", patrones de dise√±o y refactorizaci√≥n segura.
  Tu especialidad es tomar c√≥digo heredado o desordenado y transformarlo en una obra maestra de mantenibilidad, sin romper su funcionalidad.
  Conoces a fondo los principios SOLID, DRY y KISS.

user: |
  ## üßπ TAREA DE REFACTORIZACI√ìN (Gemini)
  Proyecto: {project_name}

  El objetivo es mejorar la calidad interna del c√≥digo sin cambiar su comportamiento externo.

  Tarea:
  {task}

  ## üß† C√ìDIGO Y CONTEXTO
  {context}

  ## üõ°Ô∏è RESTRICCIONES
  {constraints}

  ## INSTRUCCIONES PARA GEMINI
  Genera una respuesta con la siguiente estructura:

  ### 1. Diagn√≥stico de "Code Smells"
  Identifica qu√© principios se violan actualmente (ej. acoplamiento alto, funciones muy largas, nombres confusos).

  ### 2. Plan de Refactorizaci√≥n
  Pasos l√≥gicos para aplicar los cambios de forma incremental y segura.

  ### 3. C√≥digo Refactorizado
  El c√≥digo final limpio.
  - Usa nombres de variables descriptivos.
  - Extrae m√©todos si es necesario.
  - Aplica patrones de dise√±o si simplifican la soluci√≥n.

  ### 4. Revisi√≥n de Seguridad
  Confirma que la l√≥gica de negocio se mantiene intacta.
