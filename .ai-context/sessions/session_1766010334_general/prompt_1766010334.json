{
  "system": "Eres un experto ingeniero de software de Google, especializado en Python y QGIS.",
  "user": "Analiza la siguiente tarea para el proyecto 'sec_interp'.\n\nTarea: Implementaci√≥n de medici√≥n\n\nContexto T√©cnico:\n## GENERAL\n# Cerebro del Proyecto: sec_interp\n\n## Visi√≥n General\nPlugin de QGIS para interpretaci√≥n de secciones geol√≥gicas, manejo de sondajes (drillholes) y perfiles estructurales.\n\n## üìä M√©tricas de Salud (Actualizado: 2025-12-17)\n- **Score de Calidad**: 86.1/100 (üìà Mejora desde 82.3)\n- **L√≠neas de C√≥digo**: 11,811 en 60 m√≥dulos.\n- **Complejidad Promedio**: 21.5 (Mejorado desde 23.7).\n- **Cobertura de Docstrings**: 95.0%.\n\n## üèóÔ∏è Arquitectura Principal (Patrones Detectados)\n- **MVC (Model-View-Controller)**: Separaci√≥n clara entre la l√≥gica de QGIS (Model), los di√°logos de PyQt (View) y el coordinador (`core/controller.py`).\n- **Repository**: Manejo de persistencia y acceso a datos a trav√©s de servicios.\n- **Factory**: Creaci√≥n din√°mica de exportadores y componentes de UI.\n\n## üîó Componentes Cr√≠ticos\n1. **Controller (`core/controller.py`)**: Cerebro de la aplicaci√≥n, orquesta el flujo entre la UI y los servicios.\n2. **Services (`core/services/`)**: L√≥gica de negocio para estructuras, geolog√≠a y sondajes (`drillhole_service.py`).\n3. **Exporters (`exporters/`)**: Manejo de exportaci√≥n a Shapefile y otros formatos.\n4. **GUI (`gui/`)**: Implementaci√≥n de di√°logos PyQt5 y renderizado de previsualizaciones.\n\n## üö® Deuda T√©cnica y Prioridades\n- **Alta Complejidad**: `gui/preview_renderer.py` (Complexity 130), `gui/main_dialog_validation.py`.\n- **M√≥dulos Cr√≠ticos**: `core/services/drillhole_service.py` (Funciones muy largas, ~160 l√≠neas/promedio).\n- **Seguimiento**: `ai_workflow.py` ha sido identificado con deuda t√©cnica tras las √∫ltimas integraciones; se recomienda refactorizar para mayor modularidad.\n- **Legado**: El directorio `drillsec` ha sido mayormente limpiado, pero se debe vigilar la transici√≥n final.\n\n## üí° Pr√≥ximos pasos recomendados\n1. Refactorizar `preview_renderer.py` para reducir su complejidad extrema y n√∫mero de imports (33).\n2. Fragmentar `drillhole_service.py` para reducir el tama√±o de sus funciones.\n3. Optimizar `ai_workflow.py` para separar la l√≥gica de prompts de l\n\n## TECHNICAL\n# Stack Tecnol√≥gico: sec_interp\n\npython:\n  version: \"3.13\"\n  testing_framework: \"pytest\"\n  type_checking: null\n  formatter: \"black\"\n  linter: \"ruff / flake8 / pylint\"\n\ngis_frameworks:\n  - \"QGIS API (PyQGIS)\"\n  - \"Qt5 (PyQt5)\"\n  - \"GDAL/OGR\"\n\narchitecture:\n  pattern: \"MVC\"\n  data_access: \"Repository\"\n  ui_design: \"Programmatic (PyQt5)\"\n\ndependencies:\n  - \"qgis\"\n  - \"geometry\"\n  - \"pages\"\n  - \"spatial\"\n  - \"drillhole\"\n  - \"parsing\"\n  - \"rendering\"\n\n\nRestricciones:\n- Python 3.8+ compatible\n- Mantener retrocompatibilidad donde sea posible\n- Seguir PEP 8\n- A√±adir type hints\n- Incluir docstrings\n- Manejar errores apropiadamente\n\nInstrucciones para Gemini:\n1. Utiliza tu capacidad de razonamiento multimodal y l√≥gico para ofrecer la mejor soluci√≥n.\n2. Si se requiere c√≥digo, que sea limpio, moderno y bien documentado.\n3. Explica tus decisiones de dise√±o.\n4. Identifica posibles problemas de seguridad o rendimiento.",
  "meta": {
    "model": "gemini",
    "session_id": "session_1766010334",
    "task_type": "general",
    "estimated_tokens": 804,
    "timestamp": "2025-12-17T17:25:34.384971"
  }
}